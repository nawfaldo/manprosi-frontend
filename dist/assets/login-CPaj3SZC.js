import{u as f,a as g,b as j,r as d,j as s,A as x}from"./index-BOs4E3nY.js";import{u as w}from"./useMutation-CP5VgZfq.js";async function y(n){const a=await fetch(`${x}/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)}),o=await a.json();if(!a.ok||!o.success)throw new Error(o.error||"Login failed");return o.data}function b(){const n=f(),a=g(e=>e.setUser),o=j(),[i,m]=d.useState(""),[u,p]=d.useState(""),[r,l]=d.useState({}),c=w({mutationFn:y,onSuccess:e=>{a(e),o.setQueryData(["auth"],e);const t=e.role.toLowerCase();t==="admin"&&n({to:"/admin"}),(t==="client"||t==="farmer")&&n({to:"/client"}),t==="consultant"&&n({to:"/consultant"})},onError:e=>{l({server:e.message})}}),h=e=>{e.preventDefault();const t={};if(i.trim()||(t.username="Username is required"),u.trim()||(t.password="Password is required"),Object.keys(t).length>0){l(t);return}c.mutate({username:i,password:u})};return s.jsx("div",{children:s.jsxs("form",{onSubmit:h,children:[r.server&&s.jsx("p",{style:{color:"red"},children:r.server}),s.jsxs("div",{children:[s.jsx("input",{type:"text",value:i,onChange:e=>m(e.target.value),placeholder:"Enter your username"}),r.username&&s.jsx("p",{children:r.username})]}),s.jsxs("div",{children:[s.jsx("input",{type:"password",value:u,onChange:e=>p(e.target.value),placeholder:"Enter your password"}),r.password&&s.jsx("p",{children:r.password})]}),s.jsx("button",{type:"submit",disabled:c.isPending,children:c.isPending?"Signing in...":"Sign In"})]})})}export{b as component};
