import{R as j,u as x,b as f,j as e,A as d}from"./index-BOs4E3nY.js";import{u as y}from"./useQuery-BLzFuTEq.js";import{u as g}from"./useMutation-CP5VgZfq.js";async function b(r){const t=await fetch(`${d}/users/${r}`,{credentials:"include"}),s=await t.json();if(!t.ok||!s.success)throw new Error(s.error||"Failed to fetch user");return s.data}async function v({id:r,username:t,user_role_id:s}){const n=await fetch(`${d}/users/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:t,user_role_id:s})}),a=await n.json();if(!n.ok||!a.success)throw new Error(a.error||"Failed to update user");return a.data}function E(){const{id:r}=j.useParams(),t=x(),s=f(),{data:n,isLoading:a,isError:c,error:l}=y({queryKey:["user",r],queryFn:()=>b(r)}),i=g({mutationFn:v,onSuccess:async()=>{await s.invalidateQueries({queryKey:["users"]}),t({to:"/admin"})}}),m=o=>{o.preventDefault();const u=new FormData(o.currentTarget),p=u.get("username"),h=Number(u.get("user_role_id"));i.mutate({id:r,username:p,user_role_id:h})};return a?e.jsx("p",{children:"Loading user..."}):c?e.jsx("p",{style:{color:"red"},children:l.message}):e.jsxs("div",{children:[e.jsxs("h2",{children:["Edit User ID: ",r]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{children:[e.jsx("label",{children:"Username: "}),e.jsx("input",{name:"username",defaultValue:n.username,required:!0,type:"text"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Role: "}),e.jsxs("select",{name:"user_role_id",defaultValue:n.user_role_id,children:[e.jsx("option",{value:1,children:"Admin"}),e.jsx("option",{value:2,children:"Farmer"}),e.jsx("option",{value:3,children:"Consultant"})]})]}),e.jsx("button",{type:"submit",disabled:i.isPending,children:i.isPending?"Updating...":"Update User"})]}),i.isError&&e.jsx("p",{style:{color:"red"},children:i.error.message})]})}export{E as component};
