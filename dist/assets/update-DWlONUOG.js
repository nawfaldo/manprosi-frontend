import{p as f,u as h,b as y,r as c,j as e,A as u}from"./index-BOs4E3nY.js";import{u as b}from"./useQuery-BLzFuTEq.js";import{u as g}from"./useMutation-CP5VgZfq.js";async function j(s){const r=await fetch(`${u}/valves/${s}`,{credentials:"include"}),a=await r.json();if(!r.ok||!a.success)throw new Error(a.error);return a.data}async function N(s){const r=await fetch(`${u}/valves/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:s.name})}),a=await r.json();if(!r.ok||!a.success)throw new Error(a.error);return a.data}function q(){const{valveId:s,landId:r}=f.useParams(),a=h(),d=y(),[o,l]=c.useState(""),{data:t,isLoading:m,isError:v,error:x}=b({queryKey:["valve",s],queryFn:()=>j(s)});c.useEffect(()=>{t&&l(t.name)},[t]);const n=g({mutationFn:N,onSuccess:()=>{d.invalidateQueries({queryKey:["land-valves",r]}),d.invalidateQueries({queryKey:["valve",s]}),a({to:`/client/land/${r}`})}}),p=i=>{i.preventDefault(),o&&n.mutate({id:s,name:o})};return m?e.jsx("p",{className:"p-5",children:"Loading..."}):v?e.jsx("p",{className:"p-5 text-red-500",children:x.message}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-5 border-b border-gray-300",children:[e.jsxs("h1",{className:"py-3",children:["Edit Valve: ",t&&t.name]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{type:"submit",form:"edit-valve-form",disabled:n.isPending,className:"w-[80px] mt-1 h-[40px] border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50",children:n.isPending?"...":"Update"}),e.jsx("button",{onClick:()=>a({to:`/client/land/${r}`}),className:"w-[80px] mt-1 h-[40px] border border-red-200 text-red-600 rounded hover:bg-red-50",children:"Cancel"})]})]}),e.jsx("div",{className:"p-5",children:e.jsxs("form",{id:"edit-valve-form",onSubmit:p,className:"space-y-4 max-w-lg",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Valve Name"}),e.jsx("input",{type:"text",value:o,onChange:i=>l(i.target.value),className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"})]}),n.isError&&e.jsx("p",{className:"text-red-500 text-sm",children:n.error.message})]})})]})}export{q as component};
