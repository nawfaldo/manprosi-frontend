import{h as y,u as g,b as N,r as i,j as e,A as j}from"./index-BOs4E3nY.js";import{u as v}from"./useMutation-CP5VgZfq.js";async function w(s){const r=await fetch(`${j}/plants`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)}),n=await r.json();if(!r.ok||!n.success)throw new Error(n.error||"Failed to create plant");return n.data}function A(){const{landId:s}=y.useParams(),r=g(),n=N(),[c,x]=i.useState(""),[d,p]=i.useState(""),[l,b]=i.useState(""),[a,m]=i.useState({}),u=v({mutationFn:w,onSuccess:()=>{n.invalidateQueries({queryKey:["land-plants",s]}),r({to:`/client/land/${s}`})},onError:t=>{m({server:t.message})}}),h=t=>{t.preventDefault();const o={};if(c.trim()||(o.name="Plant name is required"),(!d||Number(d)<=0)&&(o.quantity="Quantity must be greater than 0"),l||(o.plantedAt="Planting date is required"),Object.keys(o).length>0){m(o);return}const f=l.length===16?`${l}:00`:l;u.mutate({name:c,quantity:Number(d),land_id:Number(s),planted_at:f})};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-5 border-b border-gray-300",children:[e.jsx("h1",{className:"py-3",children:"Add New Plant"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{type:"submit",form:"create-plant-form",disabled:u.isPending,className:"w-[80px] mt-1 h-[40px] border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:u.isPending?"Adding...":"Save"}),e.jsx("button",{onClick:()=>r({to:`/client/land/${s}`}),className:"w-[80px] mt-1 h-[40px] border border-red-200 text-red-600 rounded hover:bg-red-50 transition-colors",children:"Cancel"})]})]}),e.jsx("div",{className:"p-5",children:e.jsxs("form",{id:"create-plant-form",onSubmit:h,className:"space-y-4 max-w-lg",children:[a.server&&e.jsx("p",{className:"text-red-500 text-sm",children:a.server}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Plant Name"}),e.jsx("input",{type:"text",value:c,onChange:t=>x(t.target.value),placeholder:"idk",className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"}),a.name&&e.jsx("p",{className:"text-red-500 text-xs",children:a.name})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Quantity"}),e.jsx("input",{type:"number",value:d,onChange:t=>p(t.target.value),placeholder:"idk",className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"}),a.quantity&&e.jsx("p",{className:"text-red-500 text-xs",children:a.quantity})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Planted At"}),e.jsx("input",{type:"datetime-local",value:l,onChange:t=>b(t.target.value),className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black bg-white"}),a.plantedAt&&e.jsx("p",{className:"text-red-500 text-xs",children:a.plantedAt})]})]})})]})}export{A as component};
