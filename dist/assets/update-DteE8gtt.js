import{d as b,u as h,b as y,a as g,j as e,A as u}from"./index-BOs4E3nY.js";import{u as j}from"./useQuery-BLzFuTEq.js";import{u as N}from"./useMutation-CP5VgZfq.js";async function w(a){const s=await fetch(`${u}/lands/${a}`,{credentials:"include"}),t=await s.json();if(!s.ok||!t.success)throw new Error(t.error||"Failed to fetch land");return t.data}async function v({id:a,location_name:s,size:t}){const o=await fetch(`${u}/lands/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({location_name:s,size:t})}),r=await o.json();if(!o.ok||!r.success)throw new Error(r.error||"Failed to update land");return r.data}function E(){const{landId:a}=b.useParams(),s=h(),t=y(),o=g(d=>d.user),{data:r,isLoading:m,isError:p,error:x}=j({queryKey:["land",a],queryFn:()=>w(a)}),n=N({mutationFn:v,onSuccess:async()=>{await t.invalidateQueries({queryKey:["lands",o?.id]}),await t.invalidateQueries({queryKey:["land",a]}),s({to:"/client"})}}),f=d=>{d.preventDefault();const i=new FormData(d.currentTarget),l=i.get("location_name"),c=Number(i.get("size"));if(!l||c<=0){alert("Please fill valid data");return}n.mutate({id:a,location_name:l,size:c})};return m?e.jsx("p",{className:"p-5",children:"Loading land data..."}):p?e.jsx("p",{className:"p-5 text-red-500",children:x.message}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-5 border-b border-gray-300",children:[e.jsxs("h1",{className:"py-3",children:["Edit Land: ",r&&r.location_name]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{type:"submit",form:"edit-land-form",disabled:n.isPending,className:"w-[80px] mt-1 h-[40px] border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:n.isPending?"Updating...":"Update"}),e.jsx("button",{onClick:()=>s({to:"/client"}),className:"w-[80px] mt-1 h-[40px] border border-red-200 text-red-600 rounded hover:bg-red-50 transition-colors",children:"Cancel"})]})]}),e.jsx("div",{className:"p-5",children:e.jsxs("form",{id:"edit-land-form",onSubmit:f,className:"space-y-4 max-w-lg",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Location Name"}),e.jsx("input",{name:"location_name",defaultValue:r.location_name,required:!0,type:"text",placeholder:"e.g. Kebun Utara",className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Size (Hectares)"}),e.jsx("input",{name:"size",defaultValue:r.size,required:!0,type:"number",step:"0.01",placeholder:"e.g. 2.5",className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"})]}),n.isError&&e.jsx("p",{className:"text-red-500 text-sm",children:n.error.message})]})})]})}export{E as component};
