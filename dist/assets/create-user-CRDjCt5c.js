import{u as j,r as o,j as e,A as x}from"./index-BOs4E3nY.js";import{u as v}from"./useMutation-CP5VgZfq.js";async function g(i){const t=await fetch(`${x}/users`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)}),n=await t.json();if(!t.ok||!n.success)throw new Error(n.error||"Failed to create user");return n.data}function b(){const i=j(),[t,n]=o.useState(""),[l,p]=o.useState(""),[d,h]=o.useState(""),[r,c]=o.useState({}),u=v({mutationFn:g,onSuccess:()=>{i({to:"/admin"})},onError:s=>{c({server:s.message})}}),m=s=>{s.preventDefault();const a={};if(t.trim()||(a.username="Username is required"),l.trim()||(a.password="Password is required"),d||(a.role="User role is required"),Object.keys(a).length>0){c(a);return}u.mutate({username:t,password:l,user_role_id:Number(d)})};return e.jsxs("div",{children:[e.jsx("h2",{children:"Create User"}),e.jsxs("form",{onSubmit:m,children:[r.server&&e.jsx("p",{style:{color:"red"},children:r.server}),e.jsxs("div",{children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",value:t,onChange:s=>n(s.target.value),placeholder:"Enter username"}),r.username&&e.jsx("p",{children:r.username})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",value:l,onChange:s=>p(s.target.value),placeholder:"Enter password"}),r.password&&e.jsx("p",{children:r.password})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:d,onChange:s=>h(s.target.value),children:[e.jsx("option",{value:"",children:"Select a role"}),e.jsx("option",{value:"1",children:"Admin"}),e.jsx("option",{value:"2",children:"Farmer"}),e.jsx("option",{value:"3",children:"Consultant"})]}),r.role&&e.jsx("p",{children:r.role})]}),e.jsx("button",{type:"submit",disabled:u.isPending,children:u.isPending?"Creating...":"Create User"})]})]})}export{b as component};
