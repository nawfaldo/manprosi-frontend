import{f as y,u as b,b as j,r as c,j as e,A as f}from"./index-BOs4E3nY.js";import{u as g}from"./useMutation-CP5VgZfq.js";async function v(r){const n=await fetch(`${f}/sensors`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),a=await n.json();if(!n.ok||!a.success)throw new Error(a.error||"Failed to create sensor");return a.data}function w(){const{landId:r}=y.useParams(),n=b(),a=j(),[i,m]=c.useState(""),[l,x]=c.useState(""),[t,u]=c.useState({}),d=g({mutationFn:v,onSuccess:()=>{a.invalidateQueries({queryKey:["land-sensors",r]}),n({to:`/client/land/${r}`})},onError:s=>{u({server:s.message})}}),p=s=>{x(s.target.value)},h=s=>{s.preventDefault();const o={};if(i.trim()||(o.name="Sensor name is required"),l||(o.sensorType="Sensor type is required"),Object.keys(o).length>0){u(o);return}d.mutate({name:i,sensor_type:l,land_id:Number(r)})};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-5 border-b border-gray-300",children:[e.jsx("h1",{className:"py-3",children:"Add New Sensor"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{type:"submit",form:"create-sensor-form",disabled:d.isPending,className:"w-[80px] mt-1 h-[40px] border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:d.isPending?"Adding...":"Save"}),e.jsx("button",{onClick:()=>n({to:`/client/land/${r}`}),className:"w-[80px] mt-1 h-[40px] border border-red-200 text-red-600 rounded hover:bg-red-50 transition-colors",children:"Cancel"})]})]}),e.jsx("div",{className:"p-5",children:e.jsxs("form",{id:"create-sensor-form",onSubmit:h,className:"space-y-4 max-w-lg",children:[t.server&&e.jsx("p",{className:"text-red-500 text-sm",children:t.server}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sensor Name"}),e.jsx("input",{type:"text",value:i,onChange:s=>m(s.target.value),placeholder:"idk",className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black"}),t.name&&e.jsx("p",{className:"text-red-500 text-xs",children:t.name})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sensor Type"}),e.jsxs("select",{value:l,onChange:p,className:"border border-gray-300 rounded p-2 focus:outline-none focus:border-black bg-white",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"Temperature",children:"Temperature"}),e.jsx("option",{value:"Humidity",children:"Humidity (Air)"}),e.jsx("option",{value:"SoilMoisture",children:"Soil Moisture"}),e.jsx("option",{value:"PH",children:"pH Level"}),e.jsx("option",{value:"LightIntensity",children:"Light Intensity"})]}),t.sensorType&&e.jsx("p",{className:"text-red-500 text-xs",children:t.sensorType})]})]})})]})}export{w as component};
